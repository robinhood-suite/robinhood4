{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "8eba850d_77017788",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 16,
      "author": {
        "id": 1008040
      },
      "writtenOn": "2025-10-14T08:58:57Z",
      "side": 1,
      "message": "typo: two callbackS",
      "range": {
        "startLine": 16,
        "startChar": 10,
        "endLine": 16,
        "endChar": 12
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67e996f7_61e59644",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 16,
      "author": {
        "id": 1008040
      },
      "writtenOn": "2025-10-14T08:58:57Z",
      "side": 1,
      "message": "typo: been",
      "range": {
        "startLine": 16,
        "startChar": 19,
        "endLine": 16,
        "endChar": 22
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "455a2497_ed106c78",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 16,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8eba850d_77017788",
      "range": {
        "startLine": 16,
        "startChar": 10,
        "endLine": 16,
        "endChar": 12
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "df6b66c0_34b00842",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 16,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "67e996f7_61e59644",
      "range": {
        "startLine": 16,
        "startChar": 19,
        "endLine": 16,
        "endChar": 22
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4978decd_79a6a5ba",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "Can\u0027t really say I understood everything unfortunately :(",
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2121a7e9_abdc8b72",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1464,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "major suggest: TBH, I didn\u0027t understand much about this patch. Would it be possible to add explanations for the structure/functions ? Explaining how the batch save/ack work with regard to the source and enrichment, what happens when a consumer is done enriching/updating a batch, ...",
      "range": {
        "startLine": 1464,
        "startChar": 7,
        "endLine": 1464,
        "endChar": 24
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8ff6c89_97f3d155",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1464,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-14T10:15:48Z",
      "side": 1,
      "message": "To put it simply, the source maintains a list of all batches sent for enrichment. For each batch, we store the last changelog index read for that batch, as well as the number of threads the batch was divided among.\n\nHere’s how it works: when we send a batch for enrichment, we use the save_batch callback to record the last changelog index for that batch. When a thread finishes enriching its sub-batch, it calls the ack_batch callback, which decrements the ack_required counter. If ack_required reaches 0, it means that all threads have finished enriching the batch, and the changelogs for that batch can be acknowledged.\n\nHowever, there’s trickier cases where a newer batch might finish before an older one. In that case, we need to check if there is no older batches that aren\u0027t done before acknowledging the changelog.",
      "parentUuid": "2121a7e9_abdc8b72",
      "range": {
        "startLine": 1464,
        "startChar": 7,
        "endLine": 1464,
        "endChar": 24
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b20bf957_380ce17d",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1464,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T10:26:15Z",
      "side": 1,
      "message": "OK I understand now, thanks a lot (adding this as a comment would still be nice)",
      "parentUuid": "b8ff6c89_97f3d155",
      "range": {
        "startLine": 1464,
        "startChar": 7,
        "endLine": 1464,
        "endChar": 24
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8098b938_15a7cdaa",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1464,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b20bf957_380ce17d",
      "range": {
        "startLine": 1464,
        "startChar": 7,
        "endLine": 1464,
        "endChar": 24
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8c09aafb_fcc43ce5",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1483,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "typo: generated",
      "range": {
        "startLine": 1483,
        "startChar": 66,
        "endLine": 1483,
        "endChar": 74
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3d8a1bde_a36f6f25",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1483,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8c09aafb_fcc43ce5",
      "range": {
        "startLine": 1483,
        "startChar": 66,
        "endLine": 1483,
        "endChar": 74
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44f085ac_9f5cb3c5",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1484,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "typo: don\u0027t",
      "range": {
        "startLine": 1484,
        "startChar": 27,
        "endLine": 1484,
        "endChar": 32
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3e84b87f_949b283c",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1484,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "44f085ac_9f5cb3c5",
      "range": {
        "startLine": 1484,
        "startChar": 27,
        "endLine": 1484,
        "endChar": 32
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1cbab3b0_d6f86d67",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1485,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "typo: handled",
      "range": {
        "startLine": 1485,
        "startChar": 25,
        "endLine": 1485,
        "endChar": 31
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e87b7b7d_b2f01d58",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1485,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1cbab3b0_d6f86d67",
      "range": {
        "startLine": 1485,
        "startChar": 25,
        "endLine": 1485,
        "endChar": 31
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2f586068_cf8785fa",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1486,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "minor: didn\u0027t understand this part",
      "range": {
        "startLine": 1485,
        "startChar": 33,
        "endLine": 1486,
        "endChar": 75
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46db746c_d9b1fd8b",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1486,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-14T10:15:48Z",
      "side": 1,
      "message": "Without deduplication, each changelog generates fsevents, and each fsevent is treated as a batch. However, we only want to acknowledge the changelog once the last fsevent/batch has been processed.\n\nTo achieve this, we update the batch saved for this changelog so that it matches the batch_id of the last fsevent/batch returned for that changelog. This way, only the acknowledgment from the final fsevent/batch associated with this changelog will actually acknowledge the changelog itself.",
      "parentUuid": "2f586068_cf8785fa",
      "range": {
        "startLine": 1485,
        "startChar": 33,
        "endLine": 1486,
        "endChar": 75
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fde979df_4672e880",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1486,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T10:26:15Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "46db746c_d9b1fd8b",
      "range": {
        "startLine": 1485,
        "startChar": 33,
        "endLine": 1486,
        "endChar": 75
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dab234af_0d021d1f",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1500,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "typo: to go to",
      "range": {
        "startLine": 1500,
        "startChar": 15,
        "endLine": 1500,
        "endChar": 20
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d157fbf0_2a3300db",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1500,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dab234af_0d021d1f",
      "range": {
        "startLine": 1500,
        "startChar": 15,
        "endLine": 1500,
        "endChar": 20
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68030782_60489e97",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1502,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "typo: kept",
      "range": {
        "startLine": 1502,
        "startChar": 35,
        "endLine": 1502,
        "endChar": 39
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e8391203_0f6ed9f0",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1502,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "68030782_60489e97",
      "range": {
        "startLine": 1502,
        "startChar": 35,
        "endLine": 1502,
        "endChar": 39
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3443cea9_1238a6c3",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1546,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2025-10-14T09:50:57Z",
      "side": 1,
      "message": "typo: found",
      "range": {
        "startLine": 1546,
        "startChar": 16,
        "endLine": 1546,
        "endChar": 23
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "18efeb79_42a601ab",
        "filename": "rbh-fsevents/src/sources/lustre.c",
        "patchSetId": 3
      },
      "lineNbr": 1546,
      "author": {
        "id": 1037727
      },
      "writtenOn": "2025-10-15T14:44:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3443cea9_1238a6c3",
      "range": {
        "startLine": 1546,
        "startChar": 16,
        "endLine": 1546,
        "endChar": 23
      },
      "revId": "32966828108a346adb60a39627866286bcd2e958",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}